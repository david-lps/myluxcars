<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MYLUXCARS - Premium Car Rental in Orlando</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
      integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
      crossorigin=""
    ></script>
    <script src="https://unpkg.com/swiper@10/swiper-bundle.min.js"></script>
       <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
      crossorigin=""
    />
    <link rel="stylesheet" href="https://unpkg.com/swiper@10/swiper-bundle.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" />
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .gold-text {
            color: #b8860b;
        }
        .gold-bg {
            background-color: #b8860b;
        }
        .gold-border {
            border-color: #b8860b;
        }

      .navy-bg {
        /* Azuis  */
        --g1: #071a2f; /* navy quase preto */
        --g2: #061F38; /* navy profundo */
        --g3: #061F38; /* azul grafite */

        color: #fff;
        background-color: var(--g2); /* fallback */
        background-image:
          radial-gradient(60% 100% at 20% 0%, rgba(78,161,255,.10) 0%, rgba(78,161,255,0) 60%),
          linear-gradient(135deg, var(--g1) 0%, var(--g2) 38%, var(--g3) 100%);
        box-shadow:
          inset 0 0 0 1px rgba(255,255,255,.04),
          0 10px 30px rgba(0,0,0,.35);
      }
      
        .navy-text {
            color: #001f3f;
        }
        .navy-border {
            border-color: #001f3f;
        }
        .hero-image {
            background-image: linear-gradient(rgba(0, 31, 63, 0.7), rgba(0, 31, 63, 0.7)), url('https://imageio.forbes.com/specials-images/imageserve/665f5b2c1cef7d9f00a2186a/Mercedes-Maybach-EQS-680-is-the-most-useful-ultra-luxury-electric-vehicle-in-the-U-S-/0x0.jpg?format=jpg&crop=2025,1195,x575,y315,safe&width=960');
            background-size: cover;
            background-position: center;
        }
        .car-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        .transition-all {
            transition: all 0.3s ease;
        }

        .animate-fade-in {
            animation: fadeIn 0.3s ease-out;
        }
        @keyframes fadeIn {
            from {opacity: 0; transform: scale(0.95);}
            to {opacity: 1; transform: scale(1);}
        }

        .animate-zoom { animation: zoomIn .22s ease-out }
        @keyframes zoomIn {
            from { opacity: 0; transform: translateY(6px) scale(.97) }
            to   { opacity: 1; transform: translateY(0)    scale(1) }
        }

          .card-image::after{
            content:"";
            position:absolute;inset:0;
            background:linear-gradient(to top, rgba(0,0,0,.25), rgba(0,0,0,0));
            pointer-events:none;
          }
          .skeleton {
            background: linear-gradient(90deg,#eee 25%,#f5f5f5 37%,#eee 63%);
            background-size: 400% 100%;
            animation: shimmer 1.4s ease infinite;
          }
          @keyframes shimmer {
            0% { background-position: 100% 0; }
            100%{ background-position: 0 0; }
          }

        /* Container do swiper precisa ser referência */
        .mylux-fleet { position: relative; }

        /* Forçar visibilidade das setas */
        .mylux-fleet .swiper-button-prev,
        .mylux-fleet .swiper-button-next { display: none !important; }

        /* Ícones internos menores */
        .mylux-fleet .swiper-button-prev::after,
        .mylux-fleet .swiper-button-next::after {
          font-size: 16px !important;  /* diminui tamanho */
          font-weight: 700;
          color: inherit;              /* usa o color do botão */
        }

        /* Hover */
        .mylux-fleet .swiper-button-prev:hover,
        .mylux-fleet .swiper-button-next:hover {
          background: #e5e7eb;         /* gray-200 */
          color: #374151;              /* gray-700 */
        }

        /* Estado desabilitado */
        .mylux-fleet .swiper-button-disabled {
          opacity: .4;
          cursor: not-allowed;
        }

        /* Juntas no canto direito */
        .mylux-fleet .swiper-button-next { right: 0; }
        .mylux-fleet .swiper-button-prev { right: 42px; } /* largura + gap */

        /* Responsivo */
        @media (max-width: 640px) {
          .mylux-fleet .swiper-button-prev,
          .mylux-fleet .swiper-button-next {
            top: -40px;
            width: 30px;
            height: 30px;
          }
          .mylux-fleet .swiper-button-prev { right: 36px; }
        }

        /* centraliza e dá espaço */
        .mylux-fleet ~ .swiper-pagination {
          position: static !important; /* tira do overlay */
          margin-top: 1.5rem;          /* espaço abaixo dos cards */
        }

        /* estilo das bolinhas */
        .swiper-pagination-bullet {
          background: #d1d5db; /* gray-300 */
          opacity: 1;
        }
        .swiper-pagination-bullet-active {
          background: #b8860b; /* dourado */
        }

        .ios-scroll { -webkit-overflow-scrolling: touch; }
        .pt-safe { padding-top: max(1rem, env(safe-area-inset-top)); }

        /* Flatpickr: limitar largura dentro do modal */
        #availabilityModal .flatpickr-calendar.inline {
          width: 100% !important;
          max-width: 100% !important;
          box-sizing: border-box;
        }

        #availabilityModal .flatpickr-months,
        #availabilityModal .flatpickr-weekdays,
        #availabilityModal .flatpickr-days,
        #availabilityModal .dayContainer,
        #availabilityModal .flatpickr-rContainer {
          width: 100% !important;
          max-width: 100% !important;
          box-sizing: border-box;
        }

        /* Ajuste de espaçamento no mobile para não “encostar” nas bordas */
        @media (max-width: 640px) {
          #availabilityModal .flatpickr-calendar {
            padding: 0.25rem; /* ~4px */
          }
        }

        @media (max-width: 640px) {
          #availabilityModal .flatpickr-months .flatpickr-month,
          #availabilityModal .flatpickr-weekday,
          #availabilityModal .flatpickr-day {
            font-size: 0.9rem;
          }
        }

      #fullBookingModal #fbDateCalendar:empty {
        min-height: 0;
        padding: 0;
        border-width: 0;
      }

      #fullBookingModal .flatpickr-calendar.inline {
        width: fit-content !important;   /* encolhe à largura do conteúdo */
        max-width: 100% !important;
        margin-inline: auto;             /* centraliza dentro da coluna */
        box-sizing: border-box;
      }

      /* Novo modal: tamanho compacto do calendário */
      #fullBookingModal .flatpickr-calendar { 
        font-size: 14px;            
      }

      /* Altura dos dias (quadradinhos) */
      #fullBookingModal .flatpickr-day {
        height: 30px;
        line-height: 30px;
      }

      /* Barra do mês e setas mais baixas */
      #fullBookingModal .flatpickr-months .flatpickr-month {
        height: 34px;
      }

      /* Área do seletor de horário mais baixinha */
      #fullBookingModal .flatpickr-time {
        height: 36px;
      }
      #fullBookingModal .flatpickr-time input {
        height: 32px;
        padding: 2px 6px;
      }

      #fullBookingModal .flatpickr-days { margin-left: 0 !important; }

      /* Overlay de processamento */
      #bookingProcessingOverlay {
        background: rgba(0,0,0,.55);
        backdrop-filter: blur(4px);
      }

      /* Spinner + check animado */
      .loader {
        width: 52px; height: 52px;
        border: 3px solid rgba(255,255,255,.2);
        border-top-color: #fff;
        border-radius: 50%;
        animation: spin 0.9s linear infinite;
      }
      @keyframes spin { to { transform: rotate(360deg); } }

      .check-burst {
        /* Tamanho responsivo (40–64px) */
        width: clamp(40px, 9vw, 64px);
        height: clamp(40px, 9vw, 64px);

        /* Não deixar “amassar” dentro do flex */
        flex-shrink: 0;
        min-width: clamp(40px, 9vw, 64px);
        min-height: clamp(40px, 9vw, 64px);

        /* Mantém círculo perfeito e visual */
        aspect-ratio: 1 / 1;
        border-radius: 50%;
        background: radial-gradient(circle at 30% 30%, #b3d7ff 0, #4ea1ff 20%, #0e2f50 70%);
        display: inline-flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 8px 28px rgba(0, 0, 0, .35), inset 0 0 0 2px rgba(255, 255, 255, .12);
        animation: popIn .45s ease-out both;
      }

      /* Ícone escala junto (opcional) */
      .check-burst svg { width: 55%; height: 55%; }

      /* Superfície sólida/legível para modais (quase opaca) */
      .navy-surface-solid {
        background: linear-gradient(180deg, rgba(12,23,38,.96), rgba(8,16,28,.94));
        backdrop-filter: blur(8px) saturate(115%);
        -webkit-backdrop-filter: blur(8px) saturate(115%);
        border: 1px solid rgba(255,255,255,.12);
        border-radius: 1rem;
        box-shadow:
          0 12px 36px rgba(0,0,0,.45),
          inset 0 0 0 1px rgba(255,255,255,.05);
      }
      
    </style>
</head>
<body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="navy-bg text-white py-4 px-6 sticky top-0 z-50 shadow-md">
        <div class="mx-full flex justify-between items-center">
           <div class="flex items-center space-x-2">
              <!-- Brand / Logo -->
              <a href="#home" class="inline-flex items-center gap-3" aria-label="MyLuxCars">
                <img
                  src="assets/myluxcars-logo.png"
                  sizes="(max-width: 640px) 160px, (max-width: 1024px) 200px, 240px"
                  alt="MyLuxCars"
                  class="h-7 md:h-7 w-auto select-none"
                />
              </a>
            </div>
            <div class="hidden md:flex space-x-6 items-center">
                <a href="#" id="navLookup" class="hidden md:inline text-white/90 hover:text-white">
                Consultar Reserva</a>
                <a href="#fleet" class="hover:text-gold-500 transition-all">Frota</a>
                <a href="#" 
                    onclick="openLocationsModal()"
                    class="hover:text-gold-500 transition-all">
                    Áreas Atendidas
                </a>
                <a href="#" 
                     onclick="openBenefitsModal()" 
                     cclass="hover:text-gold-500 transition-all">
                    Porque Nós
                </a>
                <!--<div class="flex space-x-2 ml-4">
                    <button class="px-3 py-1 border border-white rounded hover:bg-white hover:navy-text transition-all">EN</button>
                    <button class="px-3 py-1 border border-white rounded hover:bg-white hover:navy-text transition-all">PT</button>
                    <button class="px-3 py-1 border border-white rounded hover:bg-white hover:navy-text transition-all">ES</button>
                </div>-->
            </div>
          <button id="mobileMenuBtn" class="md:hidden rounded text-white/90" aria-label="Abrir menu" aria-expanded="false">
            <i class="fa-solid fa-bars text-2xl"></i>
          </button>
       </div>
    </nav>

  <!-- Menu Mobile -->
  <div id="mobileMenu" class="fixed inset-0 z-50 hidden">
    <!-- fundo escuro para fechar ao clicar -->
    <div id="mobileMenuOverlay" class="absolute inset-0 bg-black/60"></div>

    <!-- painel do menu -->
    <nav class="absolute top-0 right-0 h-[40%] w-64 navy-surface-solid text-white p-6 flex flex-col gap-3">
      <button id="mobileMenuClose" class="self-end -mr-2 p-2 text-white/80" aria-label="Fechar menu">
        <i class="fa-solid fa-xmark text-2xl"></i>
      </button>
      <a href="#lookup" id="mobileLookupLink" class="py-2 border-b border-white/10">Consultar Reserva</a>
      <a href="#fleet" class="py-2 border-b border-white/10">Frotas</a>
      <a href="#" 
        onclick="openLocationsModal()"
        class="hover:text-gold-500 transition-all">
        Áreas Atendidas
      </a>
      <a href="#" 
         onclick="openBenefitsModal()" 
         cclass="hover:text-gold-500 transition-all">
        Porque Nós
      </a>
      <a href="#footer" class="py-2 border-b border-white/10">Contato</a>
    </nav>
  </div>
  
    <!-- Hero Section -->
    <section id="home" class="hero-image text-white py-20 md:py-32 px-6">
        <div class="container mx-auto text-center">
            <h1 class="text-5xl md:text-5xl font-bold mb-5">Aluguel de carros premium em Orlando<br>
                Entregamos <span class="gold-text">onde </span> e <span class="gold-text">quando </span> quiser</h1>
            <a href="#fleet" class="gold-bg navy-text font-bold py-3 px-8 rounded-full text-lg hover:bg-yellow-700 hover:text-white transition-all inline-block">Selecione seu Carro</a>
        </div>
    </section>
<!-- Fleet Section -->
    <section id="fleet" class="py-16 px-6 bg-gray-50">
      <div class="container mx-auto">
        <h2 class="text-3xl font-bold text-center navy-text mb-12">Nossa frota</h2>
          
        <div class="relative">
            <!-- CONTROLES NO TOPO DIREITO -->
            <div class="absolute right-0 -top-10 sm:-top-12 z-50 flex gap-2 items-center">
              <button id="fleetPrev"
                class="w-8 h-8 rounded-full bg-gray-100 text-gray-600 hover:bg-gray-200 hover:text-gray-800 shadow flex items-center justify-center">
                <i class="fas fa-chevron-left"></i>
              </button>
              <button id="fleetNext"
                class="w-8 h-8 rounded-full bg-gray-100 text-gray-600 hover:bg-gray-200 hover:text-gray-800 shadow flex items-center justify-center">
                <i class="fas fa-chevron-right"></i>
              </button>
            </div>
        <div class="swiper mylux-fleet">
        <!-- Swiper -->
          <div class="swiper-wrapper">
            <!-- Toyota Camry -->
            <div class="swiper-slide">
              <div class="car-card bg-white rounded-lg overflow-hidden shadow-md hover:shadow-xl transition-all">
                <div class="relative h-48">
                  <img
                    src= "/assets/cars/toyota-camry.avif"
                    alt="Toyota Camry"
                    class="w-full h-full object-cover card-image"
                    loading="lazy"
                    onerror="this.classList.add('hidden'); this.nextElementSibling.classList.remove('hidden');"
                  />
                  <div class="hidden absolute inset-0 skeleton"></div>
                </div>
                <div class="p-4">
                  <h3 class="text-xl font-bold navy-text mb-2">Toyota Camry</h3>
                  <div class="flex justify-between text-gray-600 mb-4">
                    <span><i class="fas fa-calendar-alt mr-1"></i> 2025</span>
                    <span><i class="fas fa-users mr-1"></i> 5 lugares</span>
                    <span><i class="fas fa-suitcase mr-1"></i> 3 malas</span>
                  </div>
                  <div class="flex justify-between items-center">
                    <span class="text-2xl font-bold gold-text">$45<small class="text-gray-500 text-sm">/diária</small></span>
                   <!-- Para chamar o modal anterir tento o sistema completo de pagamento usar a funcao showAvailabilityModal --> 
                    <button
                        class="navy-bg text-white py-2 px-4 rounded hover:bg-blue-900 transition-all"
onclick="openFullBooking(this)"
                        data-model="Toyota Camry"
                        data-img="/assets/cars/toyota-camry.avif"
                        data-seats="5"
                        data-luggage="3"
                        data-price="60"
                      >
                        Reservar
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Ford F-150 Raptor -->
            <div class="swiper-slide">
              <div class="car-card bg-white rounded-lg overflow-hidden shadow-md hover:shadow-xl transition-all">
                <div class="relative h-48">
                  <img
                    src="/assets/cars/f-150-raptor.jpeg"
                    alt="Ford F-150 Raptor"
                    class="w-full h-full object-cover card-image"
                    loading="lazy"
                    onerror="this.classList.add('hidden'); this.nextElementSibling.classList.remove('hidden');"
                  />
                  <div class="hidden absolute inset-0 skeleton"></div>
                </div>
                <div class="p-4">
                  <h3 class="text-xl font-bold navy-text mb-2">Ford F-150 Raptor</h3>
                  <div class="flex justify-between text-gray-600 mb-4">
                    <span><i class="fas fa-calendar-alt mr-1"></i> 2025</span>
                    <span><i class="fas fa-users mr-1"></i> 5 lugares</span>
                    <span><i class="fas fa-suitcase mr-1"></i> 4 malas</span>
                  </div>
                  <div class="flex justify-between items-center">
                    <span class="text-2xl font-bold gold-text">$200<small class="text-gray-500 text-sm">/diária</small></span>
                       <button
                            class="navy-bg text-white py-2 px-4 rounded hover:bg-blue-900 transition-all"
                            onclick="openFullBooking(this)"
                            data-model="Ford F-150 Raptor"
                            data-img="/assets/cars/f-150-raptor.jpeg"
                            data-seats="5"
                            data-luggage="4"
                            data-price="200"
                          >
                            Reservar
                        </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- GMC Yukon -->
            <div class="swiper-slide">
              <div class="car-card bg-white rounded-lg overflow-hidden shadow-md hover:shadow-xl transition-all">
                <div class="relative h-48">
                  <img
                    src="/assets/cars/GMC-yukon.avif"
                    alt="GMC Yukon 2025"
                    class="w-full h-full object-cover card-image"
                    loading="lazy"
                    onerror="this.classList.add('hidden'); this.nextElementSibling.classList.remove('hidden');"
                  />
                  <div class="hidden absolute inset-0 skeleton"></div>
                </div>
                <div class="p-4">
                  <h3 class="text-xl font-bold navy-text mb-2">GMC Yukon</h3>
                  <div class="flex justify-between text-gray-600 mb-4">
                    <span><i class="fas fa-calendar-alt mr-1"></i> 2025</span>
                    <span><i class="fas fa-users mr-1"></i> 7–8 lugares</span>
                    <span><i class="fas fa-suitcase mr-1"></i> 5 malas</span>
                  </div>
                  <div class="flex justify-between items-center">
                    <span class="text-2xl font-bold gold-text">$200<small class="text-gray-500 text-sm">/diária</small></span>
                      <button
                          class="navy-bg text-white py-2 px-4 rounded hover:bg-blue-900 transition-all"
                          onclick="openFullBooking(this)"
                          data-model="GMC Yukon"
                          data-img="/assets/cars/GMC-yukon.avif"
                          data-seats="8"
                          data-luggage="6"
                          data-price="200"
                        >
                          Reservar
                      </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Mercedes-Maybach EQS 680 SUV -->
            <div class="swiper-slide">
              <div class="car-card bg-white rounded-lg overflow-hidden shadow-md hover:shadow-xl transition-all">
                <div class="relative h-48">
                  <img
                    src="/assets/cars/eqs-680-suv.jpg"
                    alt="Mercedes EQS 680 Maybach"
                    class="w-full h-full object-cover card-image"
                    loading="lazy"
                    onerror="this.classList.add('hidden'); this.nextElementSibling.classList.remove('hidden');"
                  />
                  <div class="hidden absolute inset-0 skeleton"></div>
                </div>
                <div class="p-4">
                  <h3 class="text-xl font-bold navy-text mb-2">Mercedes EQS 680 Maybach</h3>
                  <div class="flex justify-between text-gray-600 mb-4">
                    <span><i class="fas fa-calendar-alt mr-1"></i> 2024</span>
                    <span><i class="fas fa-users mr-1"></i> 4–5 lugares</span>
                    <span><i class="fas fa-suitcase mr-1"></i> 3 malas</span>
                  </div>
                  <div class="flex justify-between items-center">
                    <span class="text-2xl font-bold gold-text">$1000<small class="text-gray-500 text-sm">/diária</small></span>
                       <button
                            class="navy-bg text-white py-2 px-4 rounded hover:bg-blue-900 transition-all"
                            onclick="openFullBooking(this)"
                            data-model="Mercedes EQS 680 Maybach"
                            data-img="/assets/cars/eqs-680-suv.jpg"
                            data-seats="5"
                            data-luggage="3"
                            data-price="1000"
                          >
                            Reservar
                        </button>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Toyota Sienna Hybrid XLE -->
            <div class="swiper-slide">
              <div class="car-card bg-white rounded-lg overflow-hidden shadow-md hover:shadow-xl transition-all">
                <div class="relative h-48">
                  <img
                    src="/assets/cars/sienna-hybrid-xle.avif"
                    alt="Toyota Sienna Hybrid XLE"
                    class="w-full h-full object-cover card-image"
                    loading="lazy"
                    onerror="this.classList.add('hidden'); this.nextElementSibling.classList.remove('hidden');"
                  />
                  <div class="hidden absolute inset-0 skeleton"></div>
                </div>
                <div class="p-4">
                  <h3 class="text-xl font-bold navy-text mb-2">Sienna Hybrid XLE</h3>
                  <div class="flex justify-between text-gray-600 mb-4">
                    <span><i class="fas fa-calendar-alt mr-1"></i> 2025</span>
                    <span><i class="fas fa-users mr-1"></i> 7 lugares</span>
                    <span><i class="fas fa-suitcase mr-1"></i> 5 malas</span>
                  </div>
                  <div class="flex justify-between items-center">
                    <span class="text-2xl font-bold gold-text">$160<small class="text-gray-500 text-sm">/diária</small></span>
                    <button
                      class="navy-bg text-white py-2 px-4 rounded hover:bg-blue-900 transition-all"
                      onclick="openFullBooking(this)"
                      data-model="Sienna Hybrid XLE"
                      data-img="/assets/cars/sienna-hybrid-xle.avif"
                      data-seats="7"
                      data-luggage="5"
                      data-price="160"
                    >
                      Reservar
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Chevrolet Suburban -->
            <div class="swiper-slide">
              <div class="car-card bg-white rounded-lg overflow-hidden shadow-md hover:shadow-xl transition-all">
                <div class="relative h-48">
                  <img
                    src="/assets/cars/chevrolet-suburban.jpeg"
                    alt="Chevrolet Suburban"
                    class="w-full h-full object-cover card-image"
                    loading="lazy"
                    onerror="this.classList.add('hidden'); this.nextElementSibling.classList.remove('hidden');"
                  />
                  <div class="hidden absolute inset-0 skeleton"></div>
                </div>
                <div class="p-4">
                  <h3 class="text-xl font-bold navy-text mb-2">Suburban</h3>
                  <div class="flex justify-between text-gray-600 mb-4">
                    <span><i class="fas fa-calendar-alt mr-1"></i> 2025</span>
                    <span><i class="fas fa-users mr-1"></i> 7 lugares</span>
                    <span><i class="fas fa-suitcase mr-1"></i> 5 malas</span>
                  </div>
                  <div class="flex justify-between items-center">
                    <span class="text-2xl font-bold gold-text">$280<small class="text-gray-500 text-sm">/diária</small></span>
                    <button
                      class="navy-bg text-white py-2 px-4 rounded hover:bg-blue-900 transition-all"
                      onclick="openFullBooking(this)"
                      data-model="Suburban"
                      data-img="/assets/cars/chevrolet-suburban.jpeg"
                      data-seats="7"
                      data-luggage="5"
                      data-price="280"
                    >
                      Reservar
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Ford Mustang Convertible -->
            <div class="swiper-slide">
              <div class="car-card bg-white rounded-lg overflow-hidden shadow-md hover:shadow-xl transition-all">
                <div class="relative h-48">
                  <img
                    src="/assets/cars/ford-mustang-convertible.jpg"
                    alt="Ford Mustang Convertible"
                    class="w-full h-full object-cover card-image"
                    loading="lazy"
                    onerror="this.classList.add('hidden'); this.nextElementSibling.classList.remove('hidden');"
                  />
                  <div class="hidden absolute inset-0 skeleton"></div>
                </div>
                <div class="p-4">
                  <h3 class="text-xl font-bold navy-text mb-2">Mustang Convertible</h3>
                  <div class="flex justify-between text-gray-600 mb-4">
                    <span><i class="fas fa-calendar-alt mr-1"></i> 2025</span>
                    <span><i class="fas fa-users mr-1"></i> 4 lugares</span>
                    <span><i class="fas fa-suitcase mr-1"></i> 2 malas</span>
                  </div>
                  <div class="flex justify-between items-center">
                    <span class="text-2xl font-bold gold-text">$220<small class="text-gray-500 text-sm">/diária</small></span>
                    <button
                      class="navy-bg text-white py-2 px-4 rounded hover:bg-blue-900 transition-all"
                      onclick="openFullBooking(this)"
                      data-model="Mustang Convertible"
                      data-img="/assets/cars/ford-mustang-convertible.jpg"
                      data-seats="4"
                      data-luggage="2"
                      data-price="220"
                    >
                      Reservar
                    </button>
                  </div>
                </div>
              </div>
            </div>
            
          </div>
        </div>
          <!-- Pagination -->
        <div class="swiper-pagination mt-6 text-center"></div>
        </div>    
      </div>
    </section>
    
    <!-- Testimonials -->
    <section class="py-16 px-6 bg-white">
        <div class="container mx-auto">
            <h2 class="text-3xl font-bold text-center navy-text mb-12">O que nossos clientes dizem</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="bg-gray-50 p-6 rounded-lg shadow">
                    <div class="flex items-center mb-4">
                        <div class="gold-text text-2xl mr-2">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                        </div>
                    </div>
                    <p class="text-gray-600 mb-4">“A locação mais fácil de todas! Sem taxas escondidas. A Suburban foi perfeita para nossa viagem em família.”</p>
                    <div class="flex items-center">
                        <img src="https://randomuser.me/api/portraits/women/43.jpg" alt="Customer" class="w-10 h-10 rounded-full mr-3">
                        <div>
                            <h4 class="font-semibold navy-text">Maria Silva</h4>
                            <p class="text-sm text-gray-500">From Brazil</p>
                        </div>
                    </div>
                </div>
                <div class="bg-gray-50 p-6 rounded-lg shadow">
                    <div class="flex items-center mb-4">
                        <div class="gold-text text-2xl mr-2">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                        </div>
                    </div>
                    <p class="text-gray-600 mb-4">“Não ter que pagar caução deixou essa locação muito melhor do que as outras. Carro estava impecável e luxuoso.”</p>
                    <div class="flex items-center">
                        <img src="https://randomuser.me/api/portraits/men/32.jpg" alt="Customer" class="w-10 h-10 rounded-full mr-3">
                        <div>
                            <h4 class="font-semibold navy-text">Juan Rodriguez</h4>
                            <p class="text-sm text-gray-500">From Colombia</p>
                        </div>
                    </div>
                </div>
                <div class="bg-gray-50 p-6 rounded-lg shadow">
                    <div class="flex items-center mb-4">
                        <div class="gold-text text-2xl mr-2">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                        </div>
                    </div>
                    <p class="text-gray-600 mb-4">“O suporte em vários idiomas salvou quando tivemos dúvidas. O carro foi perfeito para conhecer Orlando com estilo.”</p>
                    <div class="flex items-center">
                        <img src="https://randomuser.me/api/portraits/women/65.jpg" alt="Customer" class="w-10 h-10 rounded-full mr-3">
                        <div>
                            <h4 class="font-semibold navy-text">Sophie Martin</h4>
                            <p class="text-sm text-gray-500">From France</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section> 
    
    <!-- CTA Section -->
    <section class="navy-bg text-white py-16 px-6">
        <div class="container mx-auto text-center">
            <a href="#fleet" class="gold-bg navy-text font-bold py-3 px-8 rounded-full text-lg hover:bg-yellow-700 hover:text-white transition-all inline-block">Selecione seu Carro</a>
        </div>
    </section>

    <!-- Footer -->
    <footer id="footer" class="bg-gray-900 text-white py-12 px-6">
        <div class="container mx-auto">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <div class="flex items-center space-x-2 mb-4">
                        <i class="fas fa-car text-2xl gold-text"></i>
                        <span class="text-xl font-bold">MYLUX<span class="gold-text">CARS</span></span>
                    </div>
                    <p class="text-gray-400 mb-4">Aluguel de carros premium em Orlando. Entregamos onde e quando quiser.</p>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-4 gold-text">Links Rápidos</h3>
                    <ul class="space-y-2">
                        <li><a href="#" onclick="openLocationsModal()"
                             class="text-gray-400 hover:text-white transition-all">
                            Áreas Atendidas
                          </a>
                        </li>
                        <li><a href="#fleet" class="text-gray-400 hover:text-white transition-all">Upgrades</a></li>
                        <li>
                        <li>
                          <a href="#" 
                             onclick="openBenefitsModal()" 
                             class="text-gray-400 hover:text-white transition-all">
                            Porque Nós
                          </a>
                        </li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-4 gold-text">Contato</h3>
                    <ul class="space-y-2 text-gray-400">
                        <li class="flex items-center"><i class="fas fa-map-marker-alt mr-2 gold-text"></i> Orlando, Florida</li>
                        <li class="flex items-center"><i class="fas fa-phone mr-2 gold-text"></i> +1 (407) 555-1212</li>
                        <li class="flex items-center"><i class="fas fa-envelope mr-2 gold-text"></i> info@myluxcars.com</li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-4 gold-text">Follow Us</h3>
                    <div class="flex space-x-4">
                        <a href="#" class="text-gray-400 hover:text-white transition-all text-xl"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="text-gray-400 hover:text-white transition-all text-xl"><i class="fab fa-instagram"></i></a>
                        <a href="#" class="text-gray-400 hover:text-white transition-all text-xl"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="text-gray-400 hover:text-white transition-all text-xl"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </div>
            </div>
            <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-500">
                <p>&copy; 2025 MYLUXCARS. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Modal Benefits -->
    <div id="benefitsModal"
       class="fixed inset-0 hidden z-50 items-center justify-center bg-black/60 backdrop-blur-sm">
        <div class="relative w-11/12 max-w-4xl max-h-[85vh] overflow-y-auto bg-white rounded-2xl shadow-2xl p-5 md:p-8 animate-zoom">
            <!-- Botão fechar (redireciona) -->
            <button onclick="closeBenefitsModal()" 
                    aria-label="Fechar modal"
                    class="absolute top-3 right-3 rounded-full p-2 text-gray-600 hover:text-white hover:bg-red-500 transition">
              <i class="fas fa-times"></i>
            </button>

            <!-- Section reestruturada para modal -->
            <section id="benefits" class="py-2">
                <div class="mx-auto">
                  <h2 class="text-xl md:text-2xl font-bold text-center text-[#0e2a47] mb-6">
                    Porque MYLUXCARS
                  </h2>

                <!-- Grade responsiva: 1 / 2 / 3 colunas -->
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6">
                    <!-- item -->
                    <div class="text-center p-4 md:p-5 rounded-xl border border-gray-100 shadow-sm hover:shadow-md transition">
                      <div class="text-[#C6A25A] text-2xl md:text-3xl mb-3">
                        <i class="fas fa-shield-alt"></i>
                      </div>
                      <h3 class="text-base md:text-lg font-semibold text-[#0e2a47] mb-1">Sem Depósito Calção</h3>
                      <p class="text-sm md:text-[15px] text-gray-600">
                        Aproveite sua locação sem se preocupar com grandes cauções prendendo o seu dinheiro.
                      </p>
                    </div>

                    <div class="text-center p-4 md:p-5 rounded-xl border border-gray-100 shadow-sm hover:shadow-md transition">
                      <div class="text-[#C6A25A] text-2xl md:text-3xl mb-3">
                        <i class="fas fa-money-bill-wave"></i>
                      </div>
                      <h3 class="text-base md:text-lg font-semibold text-[#0e2a47] mb-1">Sem taxa de IOF</h3>
                      <p class="text-sm md:text-[15px] text-gray-600">
                        Eliminamos o IOF, garantindo mais economia na sua locação internacional.
                      </p>
                    </div>

                    <div class="text-center p-4 md:p-5 rounded-xl border border-gray-100 shadow-sm hover:shadow-md transition">
                      <div class="text-[#C6A25A] text-2xl md:text-3xl mb-3">
                        <i class="fas fa-car"></i>
                      </div>
                      <h3 class="text-base md:text-lg font-semibold text-[#0e2a47] mb-1">Entrega gratuíta em Orlando</h3>
                      <p class="text-sm md:text-[15px] text-gray-600">
                        Entregamos e retiramos seu carro em qualquer lugar de Orlando — sem taxas extras.
                      </p>
                    </div>

                    <div class="text-center p-4 md:p-5 rounded-xl border border-gray-100 shadow-sm hover:shadow-md transition">
                      <div class="text-[#C6A25A] text-2xl md:text-3xl mb-3">
                        <i class="fas fa-baby-carriage"></i>
                      </div>
                      <h3 class="text-base md:text-lg font-semibold text-[#0e2a47] mb-1">Cadeirinha inclusa</h3>
                      <p class="text-sm md:text-[15px] text-gray-600">
                        Todos os nossos carros familiares incluem cadeirinhas infantis sem custo adicional.
                      </p>
                    </div>

                    <div class="text-center p-4 md:p-5 rounded-xl border border-gray-100 shadow-sm hover:shadow-md transition">
                      <div class="text-[#C6A25A] text-2xl md:text-3xl mb-3">
                        <i class="fas fa-mobile-alt"></i>
                      </div>
                      <h3 class="text-base md:text-lg font-semibold text-[#0e2a47] mb-1">Web Check-in</h3>
                      <p class="text-sm md:text-[15px] text-gray-600">
                        Finalize seu check-in online antes da chegada para uma experiência mais rápida e sem contato.
                      </p>
                    </div>

                    <div class="text-center p-4 md:p-5 rounded-xl border border-gray-100 shadow-sm hover:shadow-md transition">
                      <div class="text-[#C6A25A] text-2xl md:text-3xl mb-3">
                        <i class="fas fa-globe-americas"></i>
                      </div>
                      <h3 class="text-base md:text-lg font-semibold text-[#0e2a47] mb-1">Supporte Multi-idioma</h3>
                      <p class="text-sm md:text-[15px] text-gray-600">
                        Nossa equipe fala inglês, português e espanhol para atender você com total facilidade.
                      </p>
                    </div>
                  </div>
                </div>
              </section>
            </div>
          </div>
      </div>
    </div>

    <!-- Services Areas Modal com mapa 
    <div id="locationsModal"
         class="fixed inset-0 hidden z-50 items-center justify-center bg-black/60 backdrop-blur-sm">
      <div class="relative w-11/12 max-w-5xl max-h-[88vh] bg-white rounded-2xl shadow-2xl p-4 md:p-6 flex flex-col animate-zoom">

        <div class="flex items-center justify-between gap-4 mb-3">
          <h2 class="text-lg md:text-2xl font-bold text-[#0e2a47]">
            Área de atendimento — MYLUXCARS
          </h2>
          <button onclick="closeLocationsModal()" aria-label="Fechar modal"
                  class="rounded-full p-2 text-gray-600 hover:text-white hover:bg-red-500 transition">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="flex flex-wrap items-center gap-2 md:gap-3 mb-3">
          <span class="text-sm text-gray-600 mr-2">Mostrar:</span>
          <button id="btnAirports"
                  class="px-3 py-1.5 text-sm rounded-lg border border-gray-200 bg-white hover:bg-gray-50 data-[active=true]:bg-[#0e2a47] data-[active=true]:text-white transition"
                  data-active="true"
                  onclick="toggleGroup('airports')">
            Aeroportos ✈️
          </button>
          <button id="btnCities"
                  class="px-3 py-1.5 text-sm rounded-lg border border-gray-200 bg-white hover:bg-gray-50 data-[active=true]:bg-[#0e2a47] data-[active=true]:text-white transition"
                  data-active="true"
                  onclick="toggleGroup('cities')">
            Cidades 📍
          </button>

          <div class="ml-auto flex items-center gap-2 text-xs md:text-sm text-gray-600">
            <span class="inline-flex items-center gap-1">
              <span class="h-3 w-3 inline-block rounded-full bg-blue-600"></span> Aeroporto
            </span>
            <span class="inline-flex items-center gap-1">
              <span class="h-3 w-3 inline-block rounded-full bg-amber-600"></span> Cidade
            </span>
            <button onclick="fitAllMarkers()"
                    class="ml-2 px-3 py-1.5 rounded-lg border border-gray-200 hover:bg-gray-50 transition">
                Ajustar
            </button>
          </div>
        </div>
        <div id="serviceMap" class="rounded-xl overflow-hidden border border-gray-200"
             style="height: 65vh; min-height: 360px;"></div>
        <div class="mt-3 text-center text-xs text-gray-500">
          Áreas de atendimento sujeitas à disponibilidade. Entre em contato com nossa equipe para confirmações específicas.
        </div>
      </div>
    </div>-->

  <!-- Modal: Locations -->
  <div id="locationsModal" class="fixed inset-0 hidden z-[120] overflow-y-auto">
    <div class="absolute inset-0 bg-black/70 backdrop-blur-sm"></div>
    <div class="relative z-10 min-h-full w-full flex items-center justify-center p-4">
      <div role="dialog" aria-modal="true" aria-labelledby="locationsTitle"
           class="navy-surface-solid text-white w-[min(92vw,600px)] rounded-2xl shadow-2xl p-8 text-center">

        <!-- Header -->
        <div class="mb-4 flex justify-between items-center">
          <h2 id="locationsTitle" class="text-2xl font-semibold">Áreas de Entrega</h2>
          <button onclick="closeLocationsModal()" class="text-white/70 hover:text-white text-xl" aria-label="Fechar">
            <i class="fa-solid fa-xmark"></i>
          </button>
        </div>

        <!-- Conteúdo -->
        <div class="space-y-4">
          <p class="text-lg leading-relaxed">
            Levamos o carro até você em um raio de <strong class="gold-text">30 milhas de Orlando</strong>,
            com opção de entrega também nos aeroportos de <strong>Tampa</strong> e <strong>Miami</strong>
            <span class="text-white/70">(sujeito a taxa adicional)</span>.
          </p>
        </div>

        <!-- Botão -->
        <div class="mt-6">
          <button onclick="closeLocationsModal()" id="locationsOk"
            class="px-6 py-2 rounded-lg bg-white text-slate-900 font-medium hover:opacity-95">
            Entendido
          </button>
        </div>
      </div>
    </div>
  </div>
  
    <!-- Availability Modal -->
    <div id="availabilityModal"
         class="fixed inset-0 bg-black bg-opacity-50 flex items-start sm:items-center justify-center z-50 hidden overflow-y-auto p-4 min-h-[100dvh] pt-safe">

      <div class="bg-white rounded-2xl w-full max-w-3xl mx-4 md:mx-6 shadow-2xl overflow-hidden">
        <!-- Cabeçalho -->
        <div class="flex items-center justify-between px-5 md:px-6 py-4 border-b">
          <h3 class="text-lg md:text-xl font-bold navy-text" id="modalCarTitle">Reservar</h3>
          <button onclick="closeModal()" class="rounded-full p-2 text-gray-500 hover:bg-gray-100 hover:text-gray-700 transition">
            <i class="fas fa-times"></i>
          </button>
        </div>

        <!-- Conteúdo -->
        <div class="p-5 md:p-6">
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-5">

            <!-- Coluna esquerda: veículo + resumo -->
            <div class="space-y-5">
              <!-- Veículo selecionado -->
              <div class="flex items-center p-3 bg-gray-50 rounded-xl border border-gray-100">
                <img id="selectedCarImg"
                     src="https://images.unsplash.com/photo-1541899481282-d53bffe3c35d?auto=format&fit=crop&w=400&q=70"
                     alt="Selected car"
                     class="w-20 h-20 object-cover rounded-lg mr-4">
                <div class="min-w-0">
                  <h5 class="font-semibold navy-text truncate" id="selectedCarModel">Veículo</h5>
                  <div class="flex flex-wrap gap-x-3 text-gray-600 text-sm">
                    <span id="selectedSeats"><i class="fas fa-users mr-1"></i> — lugares</span>
                    <span id="selectedLuggage"><i class="fas fa-suitcase mr-1"></i> — malas</span>
                  </div>
                </div>
              </div>

              <!-- Resumo de preço (exemplo simples) -->
              <div class="bg-gray-50 p-4 rounded-xl border border-gray-100">
                <h4 class="font-semibold navy-text mb-3">Price Summary</h4>
                <div class="flex justify-between text-sm mb-2">
                  <span class="text-gray-600"><span id="daysCount">0</span> diária(s)</span>
                  <span class="font-semibold">$<span id="calcSubtotal">0</span>.00</span>
                </div>
                <div class="flex justify-between text-sm mb-2">
                  <span class="text-gray-600">Sem taxa de IOF</span>
                  <span class="font-semibold text-green-600">$0.00</span>
                </div>
                <div class="flex justify-between text-sm mb-2">
                  <span class="text-gray-600">Sem Depósito Calção</span>
                  <span class="font-semibold text-green-600">$0.00</span>
                </div>
                <div class="border-t pt-2 mt-2 flex justify-between">
                  <span class="font-bold">Total</span>
                  <span class="font-bold text-xl gold-text">$<span id="calcTotal">0</span>.00</span>
                </div>
              </div>
            </div>

            <!-- Coluna direita: calendário + campos -->
            <div class="space-y-4">
              <!-- Calendário inline (range) -->
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Selecione as datas</label>
                <div id="dateCalendar"
                     class="rounded-xl border border-gray-200 overflow-hidden max-h-[55vh] sm:max-h-none overflow-y-auto ios-scroll
                            w-full max-w-full mx-auto">
                </div>
             </div>
              <!-- Campos preenchidos automaticamente -->
              <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                <div>
                  <label class="block text-sm text-gray-700 mb-1">Data de Retirada/label>
                  <input id="pickupDate" type="text" readonly
                         class="w-full p-2 border rounded-lg bg-gray-50 focus:outline-none focus:ring-2 focus:ring-yellow-500">
                </div>
                <div>
                  <label class="block text-sm text-gray-700 mb-1">Data de Devolução</label>
                  <input id="dropoffDate" type="text" readonly
                         class="w-full p-2 border rounded-lg bg-gray-50 focus:outline-none focus:ring-2 focus:ring-yellow-500">
                </div>
              </div>
                <button
                    type="button"                           
                    onclick="showPaymentModal(event)"       
                    class="w-full gold-bg navy-text font-bold py-3 px-4 rounded hover:bg-yellow-700 hover:text-white transition-all">
                Reserve Now
                </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Payment Modal -->
    <div id="paymentModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] hidden">
        <div class="bg-white rounded-lg p-6 w-full max-w-2xl mx-4 max-h-[90vh] sm:max-h-[85vh] overflow-y-auto ios-scroll">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold navy-text">Complete sua Reserva</h3>
                <button onclick="closePaymentModal()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <h4 class="font-semibold navy-text mb-4">Informação de Pagamento</h4>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-gray-700 mb-2">Número do Cartão</label>
                            <input type="text" placeholder="1234 5678 9012 3456" class="w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-gold-500">
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-gray-700 mb-2">Data de Expiração</label>
                                <input type="text" placeholder="MM/YY" class="w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-gold-500">
                            </div>
                            <div>
                                <label class="block text-gray-700 mb-2">CVV</label>
                                <input type="text" placeholder="123" class="w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-gold-500">
                            </div>
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">Nome do Cartão</label>
                            <input type="text" placeholder="John Doe" class="w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-gold-500">
                        </div>
                    </div>
                    <div class="mt-6">
                        <h4 class="font-semibold navy-text mb-2">Método de Pagamento</h4>
                        <div class="flex space-x-4">
                            <button class="p-2 border rounded hover:bg-gray-100 transition-all">
                                <i class="fab fa-cc-stripe text-2xl text-blue-600"></i>
                            </button>
                            <button class="p-2 border rounded hover:bg-gray-100 transition-all">
                                <i class="fab fa-cc-paypal text-2xl text-blue-500"></i>
                            </button>
                            <button class="p-2 border rounded hover:bg-gray-100 transition-all">
                                <i class="fab fa-cc-apple-pay text-2xl text-black"></i>
                            </button>
                            <button class="p-2 border rounded hover:bg-gray-100 transition-all">
                                <i class="fab fa-cc-google-pay text-2xl text-red-500"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div>
                    <h4 class="font-semibold navy-text mb-4">Resumo da Reserva</h4>
                    <div class="mb-4">
                        <div class="flex items-center p-3 bg-gray-50 rounded mb-3">
                            <img src="https://images.unsplash.com/photo-1541899481282-d53bffe3c35d?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80" alt="Car" class="w-16 h-16 object-cover rounded mr-4">
                            <div>
                                <h5 class="font-bold navy-text" id="paymentCarModel">Cadillac Escalade</h5>
                                <div class="flex text-gray-600 text-sm">
                                    <span class="mr-3"><i class="fas fa-users mr-1"></i> 7 lugares</span>
                                    <span><i class="fas fa-suitcase mr-1"></i> 4 malas</span>
                                </div>
                            </div>
                        </div>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Pick-Up Date:</span>
                                <span class="font-semibold">June 15, 2023</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Drop-Off Date:</span>
                                <span class="font-semibold">June 20, 2023</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Rental Days:</span>
                                <span class="font-semibold">5 days</span>
                            </div>
                        </div>
                    </div>
                    <div class="bg-gray-50 p-4 rounded mb-4">
                        <div class="flex justify-between mb-2">
                            <span class="text-gray-600">Subtotal</span>
                            <span class="font-semibold">$945.00</span>
                        </div>
                        <div class="flex justify-between mb-2">
                            <span class="text-gray-600">Taxes & Fees</span>
                            <span class="font-semibold">$0.00</span>
                        </div>
                        <div class="border-t border-gray-300 pt-2 mt-2 flex justify-between">
                            <span class="font-bold">Total</span>
                            <span class="font-bold text-lg gold-text">$945.00</span>
                        </div>
                    </div>
                    <div class="mb-4">
                        <label class="flex items-start">
                            <input type="checkbox" class="mt-1 mr-2">
                            <span class="text-sm text-gray-600">I agree to the <a href="#" class="gold-text hover:underline">Terms & Conditions</a> and <a href="#" class="gold-text hover:underline">Rental Agreement</a></span>
                        </label>
                    </div>
                    <button onclick="showConfirmation()" class="w-full gold-bg navy-text font-bold py-3 px-4 rounded hover:bg-yellow-700 hover:text-white transition-all">Confirm Payment</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmationModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[70] hidden">
        <div class="bg-white rounded-lg p-8 w-full max-w-md mx-4 text-center">
            <div class="gold-text text-5xl mb-4">
                <i class="fas fa-check-circle"></i>
            </div>
            <h3 class="text-2xl font-bold navy-text mb-4">Booking Confirmed!</h3>
            <p class="text-gray-600 mb-6">Your reservation for the <span id="confirmedCar" class="font-semibold">Cadillac Escalade</span> has been successfully confirmed.</p>

            <div class="mb-6 text-left bg-gray-50 p-4 rounded">
                <h4 class="font-semibold navy-text mb-2">Next Steps:</h4>
                <ol class="list-decimal list-inside space-y-2 text-sm text-gray-600">
                    <li>We'll send a confirmation email with all details</li>
                    <li>Complete your web check-in by uploading documents</li>
                    <li>Your car will be delivered to your Orlando address</li>
                </ol>
            </div>

            <div class="mb-6">
                <label class="block text-gray-700 mb-2 text-left">Delivery Address in Orlando</label>
                <input type="text" placeholder="Enter your delivery address" class="w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-gold-500 mb-2">
                <button class="w-full navy-bg text-white font-bold py-2 px-4 rounded hover:bg-blue-900 transition-all">Save Address</button>
            </div>

            <button onclick="closeConfirmationModal()" class="gold-bg navy-text font-bold py-2 px-6 rounded hover:bg-yellow-700 hover:text-white transition-all">Done</button>
        </div>
    </div>

  <!-- Full Booking Modal (novo) -->
  <div id="fullBookingModal" class="fixed inset-0 bg-black/60 backdrop-blur-sm hidden z-[65] items-start sm:items-center justify-center overflow-y-auto p-4">
    <div class="bg-white w-full max-w-5xl rounded-2xl shadow-2xl overflow-hidden animate-zoom">
      <!-- Header -->
      <div class="flex items-center justify-between px-5 md:px-6 py-4 border-b">
        <h3 class="text-lg md:text-xl font-bold navy-text">Finalize sua Reserva</h3>
        <button onclick="closeFullBooking()" class="rounded-full p-2 text-gray-500 hover:bg-gray-100 hover:text-gray-700 transition" aria-label="Fechar">
          <i class="fas fa-times"></i>
        </button>
      </div>

      <!-- Body -->
      <div class="p-5 md:p-6 grid grid-cols-1 lg:grid-cols-2 gap-5">
        <div class="space-y-3 w-[90%]">
          <!-- Datas -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Datas da locação</label>
            <div id="fbDateCalendar" class="rounded-xl border border-gray-200 w-full max-w-[360px] mx-auto p-2"></div>
            <div class="grid grid-cols-2 gap-2 mt-3">

              <!-- Retirada -->
              <div>
                <label class="block text-sm text-gray-700 mb-1">Data de Retirada</label>
                <input id="fbPickupDate" type="text" readonly class="w-full min-w-0 p-2 border rounded-lg bg-gray-50" />
              </div>
              <div>
                <label class="block text-sm text-gray-700 mb-1">Horário</label>
                <input id="fbPickupTime" type="text" class="w-full min-w-0 p-2 border rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-yellow-500"
                   placeholder="09:00" />
              </div>

              <!-- Devolução -->
              <div>
                <label class="block text-sm text-gray-700 mb-1">Data de Devolução</label>
                <input id="fbDropoffDate" type="text" readonly class="w-full min-w-0 p-2 border rounded-lg bg-gray-50" />
              </div>
              <div>
                <label class="block text-sm text-gray-700 mb-1">Horário</label>
                <input id="fbDropoffTime" type="text" class="w-full min-w-0 p-2 border rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-yellow-500"
                   placeholder="18:00" />
              </div>
            </div>
          </div>

          <!-- Endereços -->
          <div class="space-y-3">
            <div>
              <label class="block text-sm text-gray-700 mb-1">Endereço de retirada (FL)</label>
              <input id="fbPickupAddr" list="floridaAddresses" class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500" placeholder="Ex: Orlando International Airport (MCO), Orlando, FL" />
              <p id="fbPickupWarn" class="hidden mt-1 text-xs text-red-600">Atendemos apenas endereços na Flórida (FL).</p>
            </div>
            <div>
              <label class="block text-sm text-gray-700 mb-1">Endereço de devolução (FL)</label>
              <input id="fbDropoffAddr" list="floridaAddresses" class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500" placeholder="Ex: Disney Springs, Lake Buena Vista, FL" />
              <p id="fbDropoffWarn" class="hidden mt-1 text-xs text-red-600">Atendemos apenas endereços na Flórida (FL).</p>
            </div>

            <!-- Autocomplete simples (datalist) -->
            <datalist id="floridaAddresses">
              <option value="Orlando International Airport (MCO), Orlando, FL"></option>
              <option value="Orlando Sanford International (SFB), Sanford, FL"></option>
              <option value="Universal Orlando Resort, Orlando, FL"></option>
              <option value="Disney Springs, Lake Buena Vista, FL"></option>
              <option value="International Drive, Orlando, FL"></option>
              <option value="Kissimmee, FL"></option>
              <option value="Winter Park, FL"></option>
              <option value="Lake Buena Vista, FL"></option>
              <option value="Celebration, FL"></option>
            </datalist>
          </div>

          <!-- Contato -->
          <div class="grid grid-cols-2 gap-2 mt-3">
            <div>
              <label class="block text-sm text-gray-700 mb-1">E-mail</label>
              <input id="fbEmail" type="email" class="w-full min-w-0 p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500" placeholder="voce@email.com" />
            </div>
            <div>
              <label class="block text-sm text-gray-700 mb-1">Celular (com DDI)</label>
              <input id="fbWhatsapp" type="tel" class="w-full min-w-0 p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500" placeholder="+55 11 99999-9999" />
            </div>
          </div>

          <!-- Enviar -->
          <button id="fbSubmit" class="w-full gold-bg navy-text font-bold py-3 px-4 rounded hover:bg-yellow-700 hover:text-white transition-all">Solicitar Reserva</button>
          <p id="fbError" class="hidden text-sm text-red-600"></p>
        </div>

        <!-- Right: veículo + preço + benefícios -->
        <div class="space-y-3 w-[90%]">
          <div class="flex items-center p-3 bg-gray-50 rounded-xl border border-gray-100">
            <img id="fbCarImg" src="" alt="Car" class="w-24 h-24 object-cover rounded-lg mr-4" />
            <div class="min-w-0">
              <h5 class="font-semibold navy-text truncate" id="fbCarModel">—</h5>
              <div class="flex flex-wrap gap-x-3 text-gray-600 text-sm">
                <span id="fbSeats"><i class="fas fa-users mr-1"></i> —</span>
                <span id="fbLuggage"><i class="fas fa-suitcase mr-1"></i> —</span>
              </div>
            </div>
          </div>

          <div class="bg-gray-50 p-4 rounded-xl border border-gray-100">
            <h4 class="font-semibold navy-text mb-3">Resumo de Preço</h4>
            <div class="flex justify-between text-sm mb-2">
              <span class="text-gray-600"><span id="fbDays">0</span> diária(s)</span>
              <span class="font-semibold">$<span id="fbSubtotal">0</span>.00</span>
            </div>
            <div class="flex justify-between text-sm mb-2">
              <span class="text-gray-600">Sem IOF</span><span class="font-semibold text-green-600">$0.00</span>
            </div>
            <div class="flex justify-between text-sm mb-2">
              <span class="text-gray-600">Sem caução</span><span class="font-semibold text-green-600">$0.00</span>
            </div>
            <div class="border-t pt-2 mt-2 flex justify-between">
              <span class="font-bold">Total</span>
              <span class="font-bold text-xl gold-text">$<span id="fbTotal">0</span>.00</span>
            </div>
          </div>

          <div class="p-4 rounded-xl border border-amber-200 bg-amber-50">
            <h4 class="font-semibold text-amber-800 mb-3">Incluso na diária:</h4>
            <ul class="space-y-2 text-sm text-amber-900">
              <li>⛽ Tanque cheio; devolução igual ou taxa de US$ 50</li>
              <li>👶 Cadeirinha de bebê</li>
              <li>🛡️ Seguro completo (incluindo terceiros)</li>
              <li>👥 Condutores adicionais sem custo</li>
              <li>🚗 Sunpass</li>
              <li>💳 Pagamento até 10x em moeda local</li>
              <li>🛬 Carro estará pronto no local de retirada</li>
              <li>☎️ Atendimento 24h em português</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Overlay de Processamento -->
  <div id="bookingProcessingOverlay" class="fixed inset-0 hidden z-[100] grid place-items-center">
    <div class="navy-bg-glass p-8 rounded-2xl text-center w-[min(92vw,420px)]">
      <div class="mx-auto loader mb-5"></div>
      <h3 class="text-xl font-semibold">Processando sua reserva…</h3>
      <p class="text-white/80 mt-2 text-sm">
        Em instantes vamos gerar o seu código e preparar a confirmação.
      </p>
    </div>
  </div>

  <!-- Modal: Reserva Processada -->
  <div id="bookingProcessedModal" class="fixed inset-0 hidden z-[110] overflow-y-auto overscroll-contain">
    <div class="absolute inset-0 bg-black/70 backdrop-blur-[2px]"></div>
    <div class="relative z-10 min-h-full w-full flex items-center justify-center p-4">
      
      <div role="dialog" aria-modal="true" aria-labelledby="bookingProcessedTitle"
        class="navy-surface-solid text-white w-[min(92vw,780px)] max-h-[90vh] md:max-h-[82vh] overflow-y-auto shadow-2xl">
        <!-- Header -->
        <div class="navy-bg px-6 py-5 flex items-center gap-4">
          <div class="check-burst">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
              <path d="M20 6L9 17l-5-5" stroke="#fff" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <div>
            <h2 id="bookingProcessedTitle" class="text-2xl font-semibold">Reserva recebida!</h2>
            <p class="text-white/80 text-sm">Tudo certo — geramos o seu código de acompanhamento.</p>
          </div>
          <button id="bpCloseX" aria-label="Fechar"
                  class="ml-auto text-white/70 hover:text-white transition">
            <i class="fa-solid fa-xmark text-xl"></i>
          </button>
        </div>

        <!-- Corpo -->
        <div class="p-6 grid md:grid-cols-5 gap-6">
          <!-- Coluna principal -->
          <div class="md:col-span-3 space-y-4">
            <p class="text-white/90 leading-relaxed">
              Você receberá <strong>a confirmação da reserva </strong> e entraremos em contato para a <strong>etapa final de pagamento</strong>.
            </p>
            <div class="bg-white/5 rounded-xl p-4 border border-white/10">
              <div class="flex items-center gap-3">
                <span class="text-white/70 text-sm">Seu código:</span>
                <code id="bpCode" class="text-[13px] font-semibold tracking-wide bg-black/20 px-2.5 py-1.5 rounded">—</code>
                <button id="bpCopy" class="ml-2 text-xs px-2.5 py-1.5 rounded bg-white/10 hover:bg-white/15 border border-white/10">
                  Copiar
                </button>
              </div>
              <p class="text-white/70 mt-2 text-sm">
                Guarde este código para acompanhar sua reserva pelo site.
              </p>
            </div>

            <!-- Linha do tempo -->
            <div class="space-y-3">
              <h3 class="font-semibold">Próximos passos</h3>
              <ol class="text-sm space-y-2">
                <li class="flex items-start gap-3">
                  <span class="mt-1 text-emerald-400"><i class="fa-solid fa-circle-check"></i></span>
                  <span>Recebemos sua solicitação <span class="text-white/60">(agora)</span></span>
                </li>
                <li class="flex items-start gap-3">
                  <span class="mt-1 text-amber-300"><i class="fa-solid fa-hourglass-half"></i></span>
                  <span>Validação de disponibilidade <span class="text-white/60">(até 1h)</span></span>
                </li>
                <li class="flex items-start gap-3">
                  <span class="mt-1 text-sky-300"><i class="fa-solid fa-credit-card"></i></span>
                  <span>Confirmação + link de pagamento</span>
                </li>
              </ol>
            </div>

            <div class="flex gap-3 pt-2 flex-wrap">
              <a id="bpTrack" href="#" class="px-4 py-2 rounded-lg bg-white text-slate-900 font-medium hover:opacity-95">
                Acompanhar minha reserva
              </a>
              <a id="bpICS" href="#" download="Minha-Reserva.ics"
                 class="px-4 py-2 rounded-lg bg-white/10 border border-white/15 hover:bg-white/15">
                Adicionar ao calendário
              </a>
              <button id="bpClose" class="px-4 py-2 rounded-lg bg-white/10 border border-white/15 hover:bg-white/15">
                Voltar ao início
              </button>
            </div>
          </div>

          <!-- Coluna resumo -->
          <aside class="md:col-span-2 space-y-3">
            <h3 class="font-semibold">Resumo da reserva</h3>
            <div class="bg-white/5 rounded-xl p-4 border border-white/10 text-sm space-y-2">
              <div class="flex justify-between"><span class="text-white/70">Veículo</span><span id="bpVehicle"></span></div>
              <div class="flex justify-between gap-3">
                <span class="text-white/70">Retirada</span>
                <span id="bpPickup" class="block text-right leading-tight max-w-[65%]"></span>
              </div>
              <div class="flex justify-between gap-3">
                <span class="text-white/70">Devolução</span>
                <span id="bpDropoff" class="block text-right leading-tight max-w-[65%]"></span>
              </div>
             <div class="flex justify-between"><span class="text-white/70">Extras</span><span id="bpExtras">—</span></div>
              <div class="flex justify-between"><span class="text-white/70">Diária(s)</span><span id="bpDays"></span></div>
              <div class="flex justify-between text-base font-semibold pt-2 border-t border-white/10">
                <span>Total $</span><span id="bpTotal">—</span>
              </div>
            </div>

            <div class="bg-white/5 rounded-xl p-4 border border-white/10 text-sm">
              <div><span class="text-white/70">Confirmação enviada para</span> <span id="bpEmail"></span></div>
              <div class="text-white/60 mt-1 text-xs">Você pode responder ao e-mail para qualquer ajuste.</div>
            </div>
          </aside>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal: Consulta de Reserva -->
  <div id="bookingLookupModal" class="fixed inset-0 hidden z-[120] overflow-y-auto">
    <div class="absolute inset-0 bg-black/70 backdrop-blur-[2px]"></div>
    <div class="relative z-10 min-h-full w-full flex items-center justify-center p-4">
      <div role="dialog" aria-modal="true" aria-labelledby="lookupTitle"
           class="navy-surface-solid text-white w-[min(92vw,720px)] max-h-[88vh] overflow-y-auto rounded-2xl shadow-2xl">
        <div class="navy-bg px-6 py-5 flex items-center gap-4">
          <div class="check-burst" aria-hidden="true">
            <i class="fa-solid fa-magnifying-glass"></i>
          </div>
          <div>
            <h2 id="lookupTitle" class="text-2xl font-semibold">Consultar reserva</h2>
            <p class="text-white/80 text-sm">Use o seu código (ex.: MLC-ORL-2025-09-08-AB27)</p>
          </div>
          <button id="lookupCloseX" class="ml-auto text-white/70 hover:text-white" aria-label="Fechar">
            <i class="fa-solid fa-xmark text-xl"></i>
          </button>
        </div>

        <div class="p-6 space-y-4">
          <div class="flex flex-col sm:flex-row gap-3">
            <input id="lookupCode" type="text" inputmode="latin"
                   class="w-full bg-white/10 border border-white/15 rounded-lg px-4 py-2.5 placeholder-white/50"
                   placeholder="Digite seu código de reserva">
            <button id="lookupBtn" class="navy-bg text-white rounded-lg px-5 py-2.5">Consultar</button>
          </div>

          <div id="lookupResult" class="hidden">
            <h3 class="text-lg font-semibold">Resultado</h3>
            <div class="bg-white/5 rounded-xl p-4 border border-white/10 text-sm space-y-2">
              <div class="flex justify-between gap-3">
                <span class="text-white/70">Código</span><span id="lrCode" class="font-medium text-right"></span>
              </div>
              <div class="flex justify-between gap-3">
                <span class="text-white/70">Veículo</span><span id="lrVehicle" class="text-right max-w-[65%]"></span>
              </div>
              <div class="flex justify-between gap-3">
                <span class="text-white/70">Retirada</span>
                <span id="lrPickup" class="block text-right leading-tight max-w-[65%]"></span>
              </div>
              <div class="flex justify-between gap-3">
                <span class="text-white/70">Devolução</span>
                <span id="lrDropoff" class="block text-right leading-tight max-w-[65%]"></span>
              </div>
              <div class="flex justify-between gap-3">
                <span class="text-white/70">Extras</span><span id="lrExtras" class="text-right max-w-[65%]"></span>
              </div>
              <div class="flex justify-between gap-3">
                <span class="text-white/70">Dias</span><span id="lrDays" class="text-right"></span>
              </div>
              <div class="flex justify-between gap-3 text-base font-semibold pt-2 border-t border-white/10">
                <span>Total</span><span id="lrTotal" class="text-right"></span>
              </div>
              <div class="flex justify-between gap-3">
                <span class="text-white/70">E-mail</span><span id="lrEmail" class="text-right max-w-[65%]"></span>
              </div>
            </div>
          </div>

          <div id="lookupEmpty" class="text-white/70 text-sm">
            Digite o código acima e clique em “Consultar”.
          </div>

          <div id="lookupError" class="hidden text-rose-300 text-sm">
            Não encontramos nenhuma reserva com esse código. Verifique e tente novamente.
          </div>

          <div class="pt-2">
            <button id="lookupClose" class="px-4 py-2 rounded-lg bg-white/10 border border-white/15 hover:bg-white/15">
              Fechar
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>


  
  <script>
        // Close modal
        function closeModal() {
            document.getElementById('availabilityModal').classList.add('hidden');
        }

        // Show payment modal
        function showPaymentModal(e) {
          if (e) { e.preventDefault(); e.stopPropagation(); }

          const avail = document.getElementById('availabilityModal');
          const pay   = document.getElementById('paymentModal');

          if (avail) {
            avail.classList.add('hidden');
            avail.style.display = ''; // limpa inline se houver
          }

          if (pay) {
            pay.classList.remove('hidden');
            pay.style.display = 'flex'; // garante visibilidade
            pay.style.zIndex = 60;      // sobrepõe o availability
            pay.scrollTo(0, 0);
          }

          document.body.style.overflow = 'hidden';
        }

        // Close payment modal
        function closePaymentModal() {
          const pay = document.getElementById('paymentModal');
          if (pay) {
            pay.classList.add('hidden');
            pay.style.display = ''; // <-- limpa o inline que mantém o modal visível
          }

          // Se nenhum outro modal estiver aberto, libera o scroll do body
          const anyOpen = !document.getElementById('availabilityModal')?.classList.contains('hidden') ||
                          !document.getElementById('confirmationModal')?.classList.contains('hidden');
          if (!anyOpen) document.body.style.overflow = '';
        }

        // Show confirmation
        function showConfirmation() {
          const pay  = document.getElementById('paymentModal');
          const conf = document.getElementById('confirmationModal');

          // Esconde Payment corretamente
          if (pay) {
            pay.classList.add('hidden');
            pay.style.display = '';   // <-- limpa o inline que podia mantê-lo visível
          }

          // Mostra Confirmation
          if (conf) {
            conf.classList.remove('hidden');
            conf.style.display = 'flex'; // garante layout flex
            conf.scrollTo(0, 0);
          }

          document.body.style.overflow = 'hidden';
        }

        function closeConfirmationModal() {
          const conf = document.getElementById('confirmationModal');
          if (conf) {
            conf.classList.add('hidden');
            conf.style.display = '';     // limpa inline
          }
          document.body.style.overflow = ''; // libera scroll do body
        }

          const modal = document.getElementById('benefitsModal');

          function openBenefitsModal() {
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            document.body.style.overflow = 'hidden';
          }

          function closeBenefitsModal() {
            modal.classList.add('hidden');
            modal.classList.remove('flex');
            document.body.style.overflow = 'auto';
          }

          // Também fecha ao clicar no backdrop
          modal?.addEventListener('click', (e) => {
            if (e.target === modal) {
              closeBenefitsModal();
            }
          });

          // Fecha com ESC
          document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && !modal.classList.contains('hidden')) {
              closeBenefitsModal();
            }
          });

          // ----- Controles do modal -----
          const locationsModal = document.getElementById('locationsModal');

          // ----- Estado global mínimo -----
          window.__serviceMapInitialized = false;
          window.__map = null;

          // Util: garante que o DOM já existe
          function onReady(fn) {
            if (document.readyState === 'loading') {
              document.addEventListener('DOMContentLoaded', fn, { once: true });
            } else {
              fn();
            }
          }

          // Abre modal e inicializa mapa no timing certo
          function openLocationsModal() {
            onReady(() => {
              const modal = document.getElementById('locationsModal');
              if (!modal) return;

              modal.classList.remove('hidden');
              modal.classList.add('flex');
              document.body.style.overflow = 'hidden';

              // Espera o modal “montar” no layout antes de tocar o mapa
              requestAnimationFrame(() => {
                requestAnimationFrame(() => {
                  if (!window.__serviceMapInitialized) {
                    initServiceMap();      // cria o mapa apenas uma vez
                  } else {
                    // Se já existe, só revalida tamanho
                    window.__map?.invalidateSize();
                    fitAllMarkers();
                  }
                  // Fallback extra (alguns browsers precisam de um tick a mais)
                  setTimeout(() => {
                    window.__map?.invalidateSize();
                    fitAllMarkers();
                  }, 60);
                });
              });
            });
          }

          function closeLocationsModal() {
            const modal = document.getElementById('locationsModal');
            if (!modal) return;
            modal.classList.add('hidden');
            modal.classList.remove('flex');
            document.body.style.overflow = 'auto';
          }

          // Fecha clicando no backdrop
          onReady(() => {
            const modal = document.getElementById('locationsModal');
            modal?.addEventListener('click', (e) => {
              if (e.target === modal) closeLocationsModal();
            });
          });

          // Fecha com ESC
          document.addEventListener('keydown', (e) => {
            const modal = document.getElementById('locationsModal');
            if (e.key === 'Escape' && modal && !modal.classList.contains('hidden')) {
              closeLocationsModal();
            }
          });

          // ----- Mapa (Leaflet) -----
          let airportLayer, cityLayer;

          function initServiceMap() {
            const mapEl = document.getElementById('serviceMap');
            if (!mapEl) return;

            // Evita criar 2x se o usuário abrir/fechar repetidamente
            if (window.__serviceMapInitialized) return;
            window.__serviceMapInitialized = true;

            const map = L.map(mapEl, { scrollWheelZoom: true });
            window.__map = map;

            // Tiles OSM
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
              maxZoom: 19,
              attribution: '&copy; OpenStreetMap contributors'
            }).addTo(map);

            // Ícones
            const airportIcon = () => L.divIcon({
              className: 'airport-pin',
              html: `<div style="transform:translate(-50%,-100%)">
                       <div style="background:#1d4ed8;color:#fff;border-radius:9999px;padding:6px 8px;box-shadow:0 6px 14px rgba(0,0,0,.25);font-size:14px;">✈️</div>
                       <div style="width:0;height:0;border-left:6px solid transparent;border-right:6px solid transparent;border-top:10px solid #1d4ed8;margin:auto"></div>
                     </div>`,
              iconSize: [30, 42],
              iconAnchor: [15, 42]
            });

            const cityIcon = () => L.divIcon({
              className: 'city-pin',
              html: `<div style="transform:translate(-50%,-100%)">
                       <div style="background:#b45309;color:#fff;border-radius:9999px;padding:6px 8px;box-shadow:0 6px 14px rgba(0,0,0,.25);font-size:14px;">📍</div>
                       <div style="width:0;height:0;border-left:6px solid transparent;border-right:6px solid transparent;border-top:10px solid #b45309;margin:auto"></div>
                     </div>`,
              iconSize: [30, 42],
              iconAnchor: [15, 42]
            });

            // Dados
            const airports = [
              { name: 'Orlando International Airport (MCO)', coords: [28.4312, -81.3081] },
              { name: 'Orlando Sanford International (SFB)', coords: [28.7776, -81.2375] },
              { name: 'Orlando Executive Airport (ORL)', coords: [28.5455, -81.3329] },
            ];
            const cities = [
              { name: 'Orlando (Downtown)', coords: [28.5383, -81.3792] },
              { name: 'Lake Buena Vista (Disney Area)', coords: [28.3772, -81.5120] },
              { name: 'Kissimmee', coords: [28.2919, -81.4076] },
              { name: 'Celebration', coords: [28.3180, -81.5410] },
              { name: 'International Drive (I-Drive)', coords: [28.4322, -81.4701] },
              { name: 'Winter Park', coords: [28.5990, -81.3392] },
              { name: 'Altamonte Springs', coords: [28.6611, -81.3656] },
              { name: 'Sanford (City)', coords: [28.8029, -81.2696] },
              { name: 'Lake Mary', coords: [28.7580, -81.3170] },
              { name: 'Winter Garden', coords: [28.5653, -81.5862] },
              { name: 'Clermont', coords: [28.5494, -81.7729] },
              { name: 'Davenport', coords: [28.1610, -81.6018] },
              { name: 'Apopka', coords: [28.6934, -81.5322] },
            ];

            airportLayer = L.layerGroup(
              airports.map(a => L.marker(a.coords, { icon: airportIcon() }).bindPopup(`<strong>${a.name}</strong><br>Pick-up & Drop-off`))
            ).addTo(map);

            cityLayer = L.layerGroup(
              cities.map(c => L.marker(c.coords, { icon: cityIcon() }).bindPopup(`<strong>${c.name}</strong><br>Atendemos nessa região`))
            ).addTo(map);

            fitAllMarkers(); // enquadra tudo
          }

          // Enquadra os marcadores visíveis
          function fitAllMarkers() {
            const map = window.__map;
            if (!map) return;
            const visible = [];
            if (map.hasLayer(airportLayer)) visible.push(...airportLayer.getLayers());
            if (map.hasLayer(cityLayer)) visible.push(...cityLayer.getLayers());
            if (!visible.length) return;

            const group = L.featureGroup(visible);
            map.fitBounds(group.getBounds(), { padding: [30, 30] });
          }

          // Botões de filtro (se você adicionou no header do modal)
          function toggleGroup(group) {
            const map = window.__map;
            if (!map) return;
            const btnAir = document.getElementById('btnAirports');
            const btnCity = document.getElementById('btnCities');

            if (group === 'airports') {
              const active = btnAir?.getAttribute('data-active') === 'true';
              btnAir?.setAttribute('data-active', (!active).toString());
              (!active) ? map.addLayer(airportLayer) : map.removeLayer(airportLayer);
            } else {
              const active = btnCity?.getAttribute('data-active') === 'true';
              btnCity?.setAttribute('data-active', (!active).toString());
              (!active) ? map.addLayer(cityLayer) : map.removeLayer(cityLayer);
            }
            fitAllMarkers();
          }

          const fleetSwiper = new Swiper('.mylux-fleet', {
            speed: 500,
            spaceBetween: 24,
            loop: true,
            grabCursor: true,
            slidesPerView: 1,
            pagination: { el: '.swiper-pagination', clickable: true },
            navigation: { nextEl: '#fleetNext', prevEl: '#fleetPrev' }, 
            breakpoints: { 768: { slidesPerView: 2 }, 1024:{ slidesPerView: 3 } },
            preloadImages: false,
            lazy: { loadPrevNext: true, loadPrevNextAmount: 2 }
          });

          // helper: formata YYYY-MM-DD -> MMM DD, YYYY (simples)
          function formatDisplay(d) {
            if (!d) return "";
            const dt = new Date(d);
            return dt.toLocaleDateString(undefined, { year: 'numeric', month: 'short', day: '2-digit' });
          }

          // guarda preço diário do carro atual
          let __currentDailyPrice = 0;

          // Abre o modal lendo os data-* do botão clicado
          function showAvailabilityModal(btnEl) {
              const pay = document.getElementById('paymentModal');
              if (pay) { pay.classList.add('hidden'); pay.style.display = ''; }
              
            // lê dataset do botão
            const model = btnEl.dataset.model || 'Selected Vehicle';
            const img   = btnEl.dataset.img   || 'https://images.unsplash.com/photo-1541899481282-d53bffe3c35d?auto=format&fit=crop&w=800&q=70';
            const seats = btnEl.dataset.seats || '-';
            const lug   = btnEl.dataset.luggage || '-';
            const price = Number(btnEl.dataset.price || 0);

            __currentDailyPrice = price;

            // Preenche elementos
            document.getElementById('modalCarTitle').textContent = `Check Availability — ${model}`;
            document.getElementById('selectedCarModel').textContent = model;
            document.getElementById('selectedCarImg').src = img;
            document.getElementById('selectedSeats').innerHTML = `<i class="fas fa-users mr-1"></i> ${seats} seats`;
            document.getElementById('selectedLuggage').innerHTML = `<i class="fas fa-suitcase mr-1"></i> ${lug} luggage`;

            // Limpa campos de datas e preço
            document.getElementById('pickupDate').value = '';
            document.getElementById('dropoffDate').value = '';
            document.getElementById('daysCount').textContent = '0';
            document.getElementById('calcSubtotal').textContent = '0';
            document.getElementById('calcTotal').textContent = '0';

            // Abre modal
            document.getElementById('availabilityModal').classList.remove('hidden');
            document.body.style.overflow = 'hidden';            // trava o fundo
            document.getElementById('availabilityModal')?.scrollTo(0, 0);     // garante topo do overlay
            document.getElementById('availabilityCard')?.scrollTo({ top: 0 }); // garante topo do card
            document.getElementById('availabilityCard')?.focus();              // acessibilidade

            // Inicializa (ou reinicializa) o calendário inline
            initInlineRangeCalendar();
          }

          function closeModal() {
            document.getElementById('availabilityModal').classList.add('hidden');
            document.body.style.overflow = ''; 
          }

          // Flatpickr inline range
          let __fp; // instância
          function initInlineRangeCalendar() {
            const calContainer = document.getElementById('dateCalendar');
            if (!calContainer) return;

            // destrói instância anterior, se houver
            if (__fp && __fp.destroy) { __fp.destroy(); }

            __fp = flatpickr(calContainer, {
              inline: true,
              mode: 'range',
              minDate: 'today',
              dateFormat: 'Y-m-d',
              weekNumbers: false,
              onChange: function (selectedDates) {
                // quando tiver 2 datas, preenche campos
                if (selectedDates.length === 2) {
                  const [start, end] = selectedDates;
                  const pickup = start.toISOString().slice(0,10);
                  const drop   = end.toISOString().slice(0,10);

                  // Preenche inputs readonly
                  document.getElementById('pickupDate').value  = formatDisplay(pickup);
                  document.getElementById('dropoffDate').value = formatDisplay(drop);

                  // Calcula diárias (diferença em dias)
                  const msPerDay = 24 * 60 * 60 * 1000;
                  const days = Math.max(1, Math.round((end - start) / msPerDay));
                  document.getElementById('daysCount').textContent = String(days);

                  const subtotal = days * __currentDailyPrice;
                  document.getElementById('calcSubtotal').textContent = String(subtotal);
                  document.getElementById('calcTotal').textContent    = String(subtotal);
                }
              }
            });
          }

        // ==== FULL BOOKING (novo) ====
        let __fbDailyPrice = 0;
        let __fbCar = { id:'', model:'', img:'', seats:'', luggage:'' };
        let __fbFP; let __fbTimePick; let __fbTimeDrop;

        function openFullBooking(btn){
          // dados do carro
          __fbDailyPrice = Number(btn.dataset.price || 0);
          __fbCar = {
            id: btn.dataset.id || '',
            model: btn.dataset.model || 'Vehicle',
            img: btn.dataset.img || '',
            seats: btn.dataset.seats || '-',
            luggage: btn.dataset.luggage || '-'
          };

          document.getElementById('fbCarModel').innerHTML = `${__fbCar.model}` ;
          document.getElementById('fbCarImg').src = __fbCar.img;
          document.getElementById('fbSeats').innerHTML = `<i class='fas fa-users mr-1'></i> ${__fbCar.seats} assentos`;
          document.getElementById('fbLuggage').innerHTML = `<i class='fas fa-suitcase mr-1'></i> ${__fbCar.luggage} malas`;

          // reset
          setFBText('fbPickupDate',''); setFBText('fbDropoffDate','');
          setFBText('fbDays','0'); setFBText('fbSubtotal','0'); setFBText('fbTotal','0');
          document.getElementById('fbPickupAddr').value = '';
          document.getElementById('fbDropoffAddr').value = '';
          document.getElementById('fbEmail').value = '';
          document.getElementById('fbWhatsapp').value = '';

          // abre
          const m = document.getElementById('fullBookingModal');
          m.classList.remove('hidden'); m.classList.add('flex');
          document.body.style.overflow = 'hidden';
          m.scrollTo(0,0);

          initFullBookingCalendars();
        }

        function closeFullBooking(){
          const m = document.getElementById('fullBookingModal');
          m.classList.add('hidden'); m.classList.remove('flex');
          document.body.style.overflow = '';
        }

        function initFullBookingCalendars(){
          const cal = document.getElementById('fbDateCalendar');
          if(!cal) return;

          // destroy anteriores
          if(__fbFP && __fbFP.destroy) __fbFP.destroy();
          if(__fbTimePick && __fbTimePick.destroy) __fbTimePick.destroy();
          if(__fbTimeDrop && __fbTimeDrop.destroy) __fbTimeDrop.destroy();

          // calendário inline range (datas)
          __fbFP = flatpickr(cal, {
            inline: true,
            mode: 'range',
            minDate: 'today',
            dateFormat: 'Y-m-d',
            weekNumbers: false,
            showMonths: 1,
            onChange(selected){
              if(selected.length === 2){
                const [start, end] = selected;
                const pu  = start.toISOString().slice(0,10);
                const dof = end.toISOString().slice(0,10);
                setFBText('fbPickupDate', formatDisplay(pu));
                setFBText('fbDropoffDate', formatDisplay(dof));
                calcFBPrice(start, end);
              }
            }
          });

          // horários (time-only)
          __fbTimePick = flatpickr('#fbPickupTime', { enableTime:true, noCalendar:true, dateFormat:'H:i', time_24hr:true, defaultDate:'09:00' });
          __fbTimeDrop = flatpickr('#fbDropoffTime', { enableTime:true, noCalendar:true, dateFormat:'H:i', time_24hr:true, defaultDate:'18:00' });

          // validação Florida (FL)
          const onlyFL = (val) => /(,\s*FL\b|Florida\b)/i.test(val || '');
          const pickup = document.getElementById('fbPickupAddr');
          const dropof = document.getElementById('fbDropoffAddr');
          const pwarn  = document.getElementById('fbPickupWarn');
          const dwarn  = document.getElementById('fbDropoffWarn');
          const check  = (el, warn) => {
            if(!el.value){ warn.classList.add('hidden'); return true; }
            const ok = onlyFL(el.value);
            warn.classList.toggle('hidden', ok);
            return ok;
          };
          ['input','blur','change'].forEach(evt=>{
            pickup.addEventListener(evt, ()=>check(pickup,pwarn));
            dropof.addEventListener(evt, ()=>check(dropof,dwarn));
          });

          // submit
          document.getElementById('fbSubmit').onclick = () => {
            const err = document.getElementById('fbError');
            err.classList.add('hidden'); err.textContent = '';

            const okFL  = onlyFL(pickup.value) && onlyFL(dropof.value);
            const days  = Number(document.getElementById('fbDays').textContent || '0');
            const email = (document.getElementById('fbEmail').value || '').trim();
            const wa    = (document.getElementById('fbWhatsapp').value || '').trim();

            if(!days){ err.textContent = 'Selecione as datas de retirada e devolução.'; err.classList.remove('hidden'); return; }
            if(!okFL){ err.textContent = 'Atendemos apenas endereços na Flórida (FL).'; err.classList.remove('hidden'); return; }
            if(!email || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)){ err.textContent='Informe um e-mail válido.'; err.classList.remove('hidden'); return; }
            if(!wa || !/^\+?\d[\d\s().-]{6,}$/.test(wa)){ err.textContent='Informe um Número válido (com DDI).'; err.classList.remove('hidden'); return; }

            const text = encodeURIComponent(
      `Solicitação de reserva
      Carro: ${__fbCar.model}
      Retirada: ${document.getElementById('fbPickupDate').value} ${document.getElementById('fbPickupTime').value} - ${pickup.value}
      Devolução: ${document.getElementById('fbDropoffDate').value} ${document.getElementById('fbDropoffTime').value} - ${dropof.value}
      Diárias: ${days}
      Total: $${document.getElementById('fbTotal').textContent}.00
      Email: ${email}
      WhatsApp: ${wa}`
            );
            const waUrl = `https://wa.me/+5511987195105?text=${text}`; 
            //window.open(waUrl, '_blank');
            closeFullBooking();
          };
        }

        function setFBText(id, val){
          const el = document.getElementById(id);
          if(!el) return;
          if('value' in el) el.value = val; else el.textContent = val;
        }

        function calcFBPrice(start, end){
          const ms = 86400000;
          const days = Math.max(1, Math.round((end - start) / ms));
          setFBText('fbDays', String(days));
          const sub = days * __fbDailyPrice;
          setFBText('fbSubtotal', String(sub));
          setFBText('fbTotal',    String(sub));
        }

    /** UTIL: mostrar/ocultar */
    function show(el){ el.classList.remove('hidden'); }
    function hide(el){ el.classList.add('hidden'); }

    /** Gera código de reserva: MLC-ORL-YYYY-MM-DD-AB12 */
    function generateBookingCode(hub = 'ORL'){
      const d = new Date();
      const pad = n => String(n).padStart(2,'0');
      const y = d.getFullYear(), m = pad(d.getMonth()+1), day = pad(d.getDate());
      const rand = Math.random().toString(36).slice(-4).toUpperCase();
      return `MLC-${hub}-${y}-${m}-${day}-${rand}`;
    }

    /** Mascara e-mail: mario@gmail.com -> m***@gmail.com */
    function maskEmail(email=''){
      if(!email || !email.includes('@')) return '—';
      const [u, domain] = email.split('@');
      const visible = u.slice(0,1);
      return `${visible}${'*'.repeat(Math.max(1, u.length-1))}@${domain}`;
    }

    /** Lê dados do UI de forma resiliente ao baseline */
    function collectBookingFromUI(){
      const $ = sel => document.querySelector(sel);
      const vehicle = (document.getElementById('fbCarModel')?.textContent || '—').trim();

      // Datas: tenta flatpickr global (se você nomeou como fbRangePicker), senão lê input/valor
      let pickupDate='—', dropoffDate='—';
      const fp = window.fbRangePicker; // se existir
      if (fp && fp.selectedDates && fp.selectedDates.length >= 1){
        const d0 = fp.selectedDates[0];
        const d1 = fp.selectedDates[1] || fp.selectedDates[0];
        const fmt = d => `${String(d.getDate()).padStart(2,'0')}/${String(d.getMonth()+1).padStart(2,'0')}/${d.getFullYear()}`;
        pickupDate = fmt(d0); dropoffDate = fmt(d1);
      } else {
        const raw = $('#fbDateCalendar')?.value || $('#fbDateInput')?.value || '';
        if (raw.includes('to')) {
          const [a,b] = raw.split('to').map(s=>s.trim());
          pickupDate = a || ''; dropoffDate = b || '';
        } else if (raw.includes('até')) {
          const [a,b] = raw.split('até').map(s=>s.trim());
          pickupDate = a || ''; dropoffDate = b || '';
        }
      }

      const pickupTime = $('#fbPickupTime')?.value || '—';
      const dropoffTime = $('#fbDropoffTime')?.value || '—';
      const pickupLoc  = $('#fbPickupAddr')?.value || $('#fbPickupLoc')?.textContent || '—';
      const dropoffLoc = $('#fbDropoffAddr')?.value || $('#fbDropoffLoc')?.textContent || '—';

      const extras = Array.from(document.querySelectorAll('[data-extra-selected="true"]'))
                     .map(el => el.getAttribute('data-extra-name')).filter(Boolean).join(', ') || '—';

      const days = $('#fbDays')?.textContent?.trim() || '—';
      const total = $('#fbTotal')?.textContent?.trim() || $('#fbSubtotal')?.textContent?.trim() || '—';

      const name  = $('#fbCustomerName')?.value || $('#customerName')?.value || '—';
      const email = $('#fbEmail')?.value || $('#customerEmail')?.value || '—';

      return {
        vehicle, pickupDate, dropoffDate, pickupTime, dropoffTime,
        pickupLocation: pickupLoc, dropoffLocation: dropoffLoc,
        extras, days, total,
        fullName: name, email
      };
    }

    /** Salva no localStorage (pendente) */
    function savePendingBooking(obj){
      try {
        const key = 'pendingBookings';
        const list = JSON.parse(localStorage.getItem(key) || '[]');
        list.unshift({ ...obj, createdAt: new Date().toISOString() });
        localStorage.setItem(key, JSON.stringify(list.slice(0,10))); // guarda últimas 10
      } catch(e){ /* ignore */ }
    }

    /** Gera arquivo ICS (evento) e retorna URL para download */
    function buildICS(booking){
      // Monta datas no formato YYYYMMDDTHHMMSS (sem fuso, suficiente)
      function parseDDMMYYYY(s){ const [dd,mm,yy] = s.split('/'); return {dd,mm,yy}; }
      function HHMMToHHMM(hhmm){ const [h,m] = (hhmm||'00:00').split(':'); return {h: (h||'00').padStart(2,'0'), m:(m||'00').padStart(2,'0')}; }

      const pD = parseDDMMYYYY(booking.pickupDate||'01/01/2025');
      const dD = parseDDMMYYYY(booking.dropoffDate||booking.pickupDate||'01/01/2025');
      const pT = HHMMToHHMM(booking.pickupTime||'10:00');
      const dT = HHMMToHHMM(booking.dropoffTime||'10:00');

      const dtStart = `${pD.yy}${pD.mm}${pD.dd}T${pT.h}${pT.m}00`;
      const dtEnd   = `${dD.yy}${dD.mm}${dD.dd}T${dT.h}${dT.m}00`;

      const summary = `Reserva ${booking.vehicle} • MyLuxCars`;
      const location = `${booking.pickupLocation||''} → ${booking.dropoffLocation||''}`.trim();
      const notes = `Código: ${booking.code}\nDias: ${booking.days}\nTotal: ${booking.total}\nExtras: ${booking.extras || '-'}`;

      const ics =
    `BEGIN:VCALENDAR
    VERSION:2.0
    PRODID:-//MYLUXCARS//Booking//PT-BR
    CALSCALE:GREGORIAN
    BEGIN:VEVENT
    UID:${booking.code}@myluxcars
    DTSTAMP:${dtStart}
    DTSTART:${dtStart}
    DTEND:${dtEnd}
    SUMMARY:${summary}
    LOCATION:${location}
    DESCRIPTION:${notes.replace(/\n/g,'\\n')}
    END:VEVENT
    END:VCALENDAR`;

      const blob = new Blob([ics], { type: "text/calendar;charset=utf-8" });
      return URL.createObjectURL(blob);
    }

    /** Abre o modal preenchendo os campos */
    function openBookingProcessedModal(data){
      const $ = sel => document.querySelector(sel);
      $('#bpCode').textContent = data.code;
      $('#bpVehicle').textContent = data.vehicle;

      // PICKUP (com <br>)
      const p = $('#bpPickup');
      p.textContent = `${data.pickupDate} às ${data.pickupTime} `;
      p.appendChild(document.createElement('br'));
      p.append(data.pickupLocation);

      // DROPOFF (com <br>)
      const d = $('#bpDropoff');
      d.textContent = `${data.dropoffDate} às ${data.dropoffTime} `;
      d.appendChild(document.createElement('br'));
      d.append(data.dropoffLocation);

      $('#bpExtras').textContent  = data.extras;
      $('#bpDays').textContent    = data.days;
      $('#bpTotal').textContent   = data.total;
      $('#bpEmail').textContent   = maskEmail(data.email);

      // Link de acompanhamento (pode apontar para /reserva?code=...)
      const trackUrl = `/reserva?code=${encodeURIComponent(data.code)}`;
      const icsUrl = buildICS(data);

      $('#bpTrack').setAttribute('href', trackUrl);
      $('#bpICS').setAttribute('href', icsUrl);

      // Abrir
      show(document.getElementById('bookingProcessedModal'));
      // Foco acessível no título
      setTimeout(()=> document.getElementById('bookingProcessedTitle')?.focus(), 10);
    }

    /** Fluxo: botão Confirmar -> overlay -> modal final */
    async function startBookingProcessedFlow(){
      const btn = document.getElementById('fbSubmit');
      if (btn){ btn.disabled = true; btn.classList.add('opacity-70','cursor-not-allowed'); }

      show(document.getElementById('bookingProcessingOverlay'));

      // Coleta dados + gera código
      const booking = collectBookingFromUI();
      booking.code = generateBookingCode('ORL');

      // Grava a reserva 
      await persistBooking(booking);
      
      // Guarda localmente (para recuperar depois)
      savePendingBooking(booking);

      // Simula processamento (1.6s)
      await new Promise(r => setTimeout(r, 1600));

      hide(document.getElementById('bookingProcessingOverlay'));
      openBookingProcessedModal(booking);

      if (btn){ btn.disabled = false; btn.classList.remove('opacity-70','cursor-not-allowed'); }

      // (Opcional) Feche o modal de booking se estiver aberto:
      try { document.getElementById('fullBookingModal')?.classList.add('hidden'); } catch(e){}
    }

    /** Copiar código */
    function copyText(text){
      if (!navigator.clipboard) {
        const ta = document.createElement('textarea');
        ta.value = text; document.body.appendChild(ta); ta.select();
        document.execCommand('copy'); ta.remove(); return;
      }
      navigator.clipboard.writeText(text).catch(()=>{});
    }

    /** Bind dos botões do modal final */
    (function initProcessedModal(){
      const $ = sel => document.querySelector(sel);
      $('#bpCopy')?.addEventListener('click', ()=>{
        const code = document.getElementById('bpCode').textContent.trim();
        copyText(code);
        // micro-toast
        const t = document.createElement('div');
        t.textContent = 'Código copiado!';
        t.className = 'fixed bottom-4 left-1/2 -translate-x-1/2 bg-black/80 text-white px-3 py-1.5 rounded-lg text-sm z-[120]';
        document.body.appendChild(t);
        setTimeout(()=> t.remove(), 1800);
      });
      const closeAll = ()=>{
        hide(document.getElementById('bookingProcessedModal'));
        // Scroll topo
        window.scrollTo({ top: 0, behavior: 'smooth' });
      };
      $('#bpClose')?.addEventListener('click', closeAll);
      $('#bpCloseX')?.addEventListener('click', closeAll);

      // Escape fecha
      document.addEventListener('keydown', (e)=>{
        if (e.key === 'Escape') hide(document.getElementById('bookingProcessedModal'));
      });
    })();

    /** Conecta o fluxo ao seu botão de confirmar da reserva (fbSubmit) */
    (function hookConfirmButton(){
      const btn = document.getElementById('fbSubmit');
      if (!btn) return;
      btn.addEventListener('click', function(e){
        e.preventDefault(); // impede submit padrão / WhatsApp
        startBookingProcessedFlow();
      });
    })();

    (function(){
      const btn = document.getElementById('mobileMenuBtn');
      const menu = document.getElementById('mobileMenu');
      const overlay = document.getElementById('mobileMenuOverlay');
      const closeBtn = document.getElementById('mobileMenuClose');

      function openMenu(){
        menu.classList.remove('hidden');
        document.documentElement.classList.add('overflow-hidden');
        btn?.setAttribute('aria-expanded','true');
      }
      function closeMenu(){
        menu.classList.add('hidden');
        document.documentElement.classList.remove('overflow-hidden');
        btn?.setAttribute('aria-expanded','false');
      }

      btn?.addEventListener('click', openMenu);
      overlay?.addEventListener('click', closeMenu);
      closeBtn?.addEventListener('click', closeMenu);

      // Fechar ao clicar num link
      menu.querySelectorAll('a[href^="#"]').forEach(a=>{
        a.addEventListener('click', closeMenu);
      });

      // ESC fecha
      document.addEventListener('keydown', (e)=>{
        if (e.key === 'Escape' && !menu.classList.contains('hidden')) closeMenu();
      });
    })();


    /* === UTIL de modal === */
    function show(el){ el.classList.remove('hidden'); }
    function hide(el){ el.classList.add('hidden'); }

    /* === 3.A Abrir/fechar modal de consulta === */
    (function initLookupModal(){
      const btn = document.getElementById('navLookup');
      const btnMobile = document.getElementById('mobileLookupLink');
      const modal = document.getElementById('bookingLookupModal');
      const closeBtn = document.getElementById('lookupClose');
      const closeX = document.getElementById('lookupCloseX');

      function open(){ show(modal); document.documentElement.classList.add('overflow-hidden'); }
      function close(){ hide(modal); document.documentElement.classList.remove('overflow-hidden'); }

      btn?.addEventListener('click', (e)=>{ e.preventDefault(); open(); });
      btnMobile?.addEventListener('click', (e)=>{ e.preventDefault(); open(); });
      closeBtn?.addEventListener('click', close);
      closeX?.addEventListener('click', close);
      modal.addEventListener('click', (e)=>{ if(e.target === modal) close(); });
      document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') close(); });
    })();

    /* === 3.B Persistência: front agora, backend quando existir === */
    async function persistBooking(booking){
      // LocalStorage (sempre)
      try {
        const key = 'bookings';
        const list = JSON.parse(localStorage.getItem(key) || '[]');
        // se já existir com o mesmo code, substitui
        const idx = list.findIndex(b => b.code === booking.code);
        if (idx >= 0) list[idx] = booking; else list.unshift(booking);
        localStorage.setItem(key, JSON.stringify(list.slice(0,200)));
      } catch (e) {}

      // Backend (opcional): tenta POST /api/bookings; se 404, ignora
      try {
        await fetch('/api/bookings', {
          method:'POST',
          headers:{'Content-Type':'application/json'},
          body: JSON.stringify(booking)
        });
      } catch (e) {
        // sem backend, tudo bem
      }
    }

    /* === 3.C Consulta por código === */
    async function lookupBookingByCode(code){
      code = String(code||'').trim();
      if (!code) return null;

      // 1) Tenta backend GET /api/bookings/:code
      try {
        const r = await fetch(`/api/bookings/${encodeURIComponent(code)}`, { cache:'no-store' });
        if (r.ok) {
          const data = await r.json();
          if (data && data.code) return data;
        }
      } catch(e){ /* ignora, tenta local */ }

      // 2) Tenta ler do bookings.json estático
      try {
        const r = await fetch('/bookings.json', { cache: 'no-store' });
        if (r.ok) {
          const arr = await r.json();
          if (Array.isArray(arr)) {
            const found = arr.find(b => String(b.code).toUpperCase() === code.toUpperCase());
            if (found) return found;
          }
        }
      } catch (e) { /* ignora se não existir */ }
      
      // 3) Fallback: LocalStorage
      try {
        const list = JSON.parse(localStorage.getItem('bookings') || '[]');
        return list.find(b => b.code === code) || null;
      } catch (e) {
        return null;
      }
    }

    /* === 3.D UI da consulta === */
    (function initLookupUI(){
      const $ = (s)=>document.querySelector(s);
      const input = $('#lookupCode');
      const btn = $('#lookupBtn');
      const boxResult = $('#lookupResult');
      const boxEmpty = $('#lookupEmpty');
      const boxErr = $('#lookupError');

      function setBr(el, top, bottom){
        el.textContent = ''; 
        el.append(document.createTextNode(top + ' '), document.createElement('br'), document.createTextNode(bottom));
      }

      btn?.addEventListener('click', async ()=>{
        boxErr.classList.add('hidden');
        boxResult.classList.add('hidden');
        boxEmpty.classList.add('hidden');

        const code = input.value.trim();
        const data = await lookupBookingByCode(code);
        if (!data){
          boxErr.classList.remove('hidden');
          return;
        }

        // Preenche resultado
        $('#lrCode').textContent = data.code;
        $('#lrVehicle').textContent = data.vehicle || '—';
        setBr($('#lrPickup'), `${data.pickupDate} às ${data.pickupTime}`, data.pickupLocation || '—');
        setBr($('#lrDropoff'), `${data.dropoffDate} às ${data.dropoffTime}`, data.dropoffLocation || '—');
        $('#lrExtras').textContent = data.extras || '—';
        $('#lrDays').textContent = data.days || '—';
        $('#lrTotal').textContent = data.total || '—';
        $('#lrEmail').textContent = data.email || '—';

        boxResult.classList.remove('hidden');
      });
    })();

    /* === 3.E Integração: salve quando GERAR a reserva ===
       Chame persistBooking(booking) logo após gerar o objeto no seu fluxo “processado”.
       EXEMPLO dentro do seu startBookingProcessedFlow():
    */
    window.__saveBookingAfterProcessed = async function(booking){
      try { await persistBooking(booking); } catch(e){}
    };

  </script>
</body>
</html>
